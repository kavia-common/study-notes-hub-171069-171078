{"is_source_file": true, "format": "JavaScript/JSX", "description": "This source file defines a React component 'NoteDetails' which presents detailed information about a single note, including metadata, actions (like, bookmark, download), PDF preview, and related UI elements. It fetches data from a Supabase backend, manages state, handles user interactions, and renders UI accordingly.", "external_files": ["../lib/supabaseClient", "../components/PdfPreview.jsx", "../context/AuthContext.jsx", "../components/LikeButton.jsx", "../components/BookmarkButton.jsx", "../components/UserAvatar.jsx", "../components/State/LoadingState.jsx", "../components/State/ErrorState.jsx"], "external_methods": ["useParams", "useNavigate", "Link", "formatDistanceToNow", "getSupabaseClient", "useAuth", "useCallback", "useEffect", "useMemo", "useState"], "published": ["NoteDetails"], "classes": [], "methods": [{"name": "fetchNote", "description": "Fetches the note data from the 'notes' table by ID and updates the component state."}, {"name": "safeUpdateCounts(patch)", "description": "Performs optimistic update of note counters locally and persists changes to the backend.", "scope": "NoteDetails", "scopeKind": "function"}, {"name": "handleLike()", "description": "Handles the like button click, incrementing the likes count.", "scope": "NoteDetails", "scopeKind": "function"}, {"name": "handleBookmark()", "description": "Handles the bookmark button click, incrementing the bookmarks count.", "scope": "NoteDetails", "scopeKind": "function"}, {"name": "handleDownload()", "description": "Handles PDF download: updates download count, generates signed URL for download, and triggers browser download.", "scope": "NoteDetails", "scopeKind": "function"}, {"name": "NoteDetails()", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["supabase.from('notes').select('*').eq('id', id).single()", "supabase.from('notes').update(patch).eq('id', id)", "supabase.storage.from('notes').createSignedUrl(note.pdf_path, 300, { download: true })", "useParams()", "useNavigate()", "useAuth()", "formatDistanceToNow()", "getSupabaseClient()"], "search-terms": ["NoteDetails", "PDF preview", "Supabase signed URL", "note metadata", "liking notes", "bookmarking notes", "downloading notes", "React useEffect/useCallback/useMemo", "note fetching and state management"], "state": 2, "file_id": 46, "knowledge_revision": 157, "git_revision": "38a1a0ac8a327c9a584fbb0cbb025ecfe61faa20", "revision_history": [{"104": ""}, {"113": "35c40cd7841f75d3b4b8648c69716d56469d4188"}, {"114": "35c40cd7841f75d3b4b8648c69716d56469d4188"}, {"156": "4fa805952bc51f2f89db2b3305d1f7c881145f49"}, {"157": "38a1a0ac8a327c9a584fbb0cbb025ecfe61faa20"}], "ctags": [{"_type": "tag", "name": "600", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^            signedSeconds={600}$/", "language": "JavaScript", "kind": "field", "scope": "signedSeconds", "scopeKind": "class"}, {"_type": "tag", "name": "720", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^            height={720}$/", "language": "JavaScript", "kind": "field", "scope": "height", "scopeKind": "class"}, {"_type": "tag", "name": "NoteDetails", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^export default function NoteDetails() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "handleBookmark", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^  async function handleBookmark() {$/", "language": "JavaScript", "kind": "function", "signature": "()", "scope": "NoteDetails", "scopeKind": "function"}, {"_type": "tag", "name": "handleDownload", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^  async function handleDownload() {$/", "language": "JavaScript", "kind": "function", "signature": "()", "scope": "NoteDetails", "scopeKind": "function"}, {"_type": "tag", "name": "handleLike", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^  async function handleLike() {$/", "language": "JavaScript", "kind": "function", "signature": "()", "scope": "NoteDetails", "scopeKind": "function"}, {"_type": "tag", "name": "note", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^              noteId={note.id}$/", "language": "JavaScript", "kind": "field", "scope": "noteId", "scopeKind": "class"}, {"_type": "tag", "name": "note", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^            fileName={note.title ? `${note.title}.pdf` : 'note.pdf'}$/", "language": "JavaScript", "kind": "field", "scope": "fileName", "scopeKind": "class"}, {"_type": "tag", "name": "note", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^            path={note.pdf_path}$/", "language": "JavaScript", "kind": "field", "scope": "path", "scopeKind": "class"}, {"_type": "tag", "name": "note", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^          {note?.user_id ? <UserAvatar userId={note.user_id} size={44} \\/> : null}$/", "language": "JavaScript", "kind": "field", "scope": "note.user_id", "scopeKind": "class"}, {"_type": "tag", "name": "safeUpdateCounts", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^  async function safeUpdateCounts(patch) {$/", "language": "JavaScript", "kind": "function", "signature": "(patch)", "scope": "NoteDetails", "scopeKind": "function"}], "hash": "7b5a6c725ade41e0c9cf6b4f033d660e", "format-version": 4, "code-base-name": "react_frontend", "filename": "react_frontend/src/pages/NoteDetails.jsx", "fields": [{"name": "signedSeconds={600}", "scope": "signedSeconds", "scopeKind": "class", "description": "unavailable"}, {"name": "height={720}", "scope": "height", "scopeKind": "class", "description": "unavailable"}, {"name": "noteId={note.id}", "scope": "noteId", "scopeKind": "class", "description": "unavailable"}, {"name": "fileName={note.title ? `${note.title}.pdf` : 'note.pdf'}", "scope": "fileName", "scopeKind": "class", "description": "unavailable"}, {"name": "path={note.pdf_path}", "scope": "path", "scopeKind": "class", "description": "unavailable"}, {"name": "{note?.user_id ? <UserAvatar userId={note.user_id} size={44} \\/> : null}", "scope": "note.user_id", "scopeKind": "class", "description": "unavailable"}]}