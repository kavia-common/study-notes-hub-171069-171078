{"is_source_file": true, "format": "JavaScript (React JSX)", "description": "This React component 'NoteDetails' displays detailed information about a single note, including metadata, actions (like, bookmark, download), and a PDF preview. It fetches data from a Supabase database and storage, handles user interactions with optimistic UI updates, and manages routing through React Router.", "external_files": ["../lib/supabaseClient", "../components/PdfPreview.jsx", "../context/AuthContext.jsx", "react", "react-router-dom", "date-fns"], "external_methods": ["useParams", "useNavigate", "Link", "formatDistanceToNow", "getSupabaseClient", "useAuth"], "published": [], "classes": [], "methods": [{"name": "NoteDetails()", "description": "Main React functional component that renders the note details page, manages state, fetches data, and handles user interactions.", "scope": "", "scopeKind": ""}, {"name": "fetchNote", "description": "Fetches the note data from the 'notes' table in Supabase based on the URL parameter 'id'."}, {"name": "safeUpdateCounts(patch)", "description": "Performs an optimistic update to local state, then persists count changes (likes, bookmarks, downloads) to the database; refetches in case of error.", "scope": "NoteDetails", "scopeKind": "function"}, {"name": "handleLike()", "description": "Increments the 'likes' count for the current note in an optimistic manner.", "scope": "NoteDetails", "scopeKind": "function"}, {"name": "handleBookmark()", "description": "Increments the 'bookmarks' count for the current note.", "scope": "NoteDetails", "scopeKind": "function"}, {"name": "handleDownload()", "description": "Increments 'downloads' count and triggers a signed URL download for the PDF file.", "scope": "NoteDetails", "scopeKind": "function"}], "calls": ["useParams()", "useNavigate()", "getSupabaseClient()", "useAuth()", "supabase.from('notes').select('*').eq('id', id).single()", "supabase.from('notes').update(patch).eq('id', id)", "supabase.storage.from('notes').createSignedUrl(note.pdf_path, 300, { download: true })", "formatDistanceToNow(createdAt, { addSuffix: true })", "document.createElement('a')", "link.click()"], "search-terms": ["NoteDetails React component", "Supabase fetch note", "PDF preview", "signed URL download", "like bookmark counts", "note metadata display"], "state": 2, "file_id": 46, "knowledge_revision": 104, "git_revision": "", "ctags": [{"_type": "tag", "name": "600", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^            signedSeconds={600}$/", "language": "JavaScript", "kind": "field", "scope": "signedSeconds", "scopeKind": "class"}, {"_type": "tag", "name": "720", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^            height={720}$/", "language": "JavaScript", "kind": "field", "scope": "height", "scopeKind": "class"}, {"_type": "tag", "name": "NoteDetails", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^export default function NoteDetails() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "handleBookmark", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^  async function handleBookmark() {$/", "language": "JavaScript", "kind": "function", "signature": "()", "scope": "NoteDetails", "scopeKind": "function"}, {"_type": "tag", "name": "handleDownload", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^  async function handleDownload() {$/", "language": "JavaScript", "kind": "function", "signature": "()", "scope": "NoteDetails", "scopeKind": "function"}, {"_type": "tag", "name": "handleLike", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^  async function handleLike() {$/", "language": "JavaScript", "kind": "function", "signature": "()", "scope": "NoteDetails", "scopeKind": "function"}, {"_type": "tag", "name": "note", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^            fileName={note.title ? `${note.title}.pdf` : 'note.pdf'}$/", "language": "JavaScript", "kind": "field", "scope": "fileName", "scopeKind": "class"}, {"_type": "tag", "name": "note", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^            path={note.pdf_path}$/", "language": "JavaScript", "kind": "field", "scope": "path", "scopeKind": "class"}, {"_type": "tag", "name": "safeUpdateCounts", "path": "/home/kavia/workspace/code-generation/study-notes-hub-171069-171078/react_frontend/src/pages/NoteDetails.jsx", "pattern": "/^  async function safeUpdateCounts(patch) {$/", "language": "JavaScript", "kind": "function", "signature": "(patch)", "scope": "NoteDetails", "scopeKind": "function"}], "hash": "b7c4adc71b56c4a7962ab217b8c7778c", "format-version": 4, "code-base-name": "react_frontend", "filename": "react_frontend/src/pages/NoteDetails.jsx", "fields": [{"name": "signedSeconds={600}", "scope": "signedSeconds", "scopeKind": "class", "description": "unavailable"}, {"name": "height={720}", "scope": "height", "scopeKind": "class", "description": "unavailable"}, {"name": "fileName={note.title ? `${note.title}.pdf` : 'note.pdf'}", "scope": "fileName", "scopeKind": "class", "description": "unavailable"}, {"name": "path={note.pdf_path}", "scope": "path", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"104": ""}]}